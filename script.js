const tarefasPorSemana = {
  semana1: [
    { id: "semana1-t1", texto: "20 flashcards em inglês" },
    { id: "semana1-t2", texto: "20 flashcards em inglês" },
    { id: "semana1-t3", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana1-t4", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana1-t5", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana1-t6", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana1-t7", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana1-t8", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana1-t9", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana1-t10", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana1-t11", texto: "1 capítulo da bíblia" },
    { id: "semana1-t12", texto: "1 capítulo da bíblia" },
    { id: "semana1-t13", texto: "1 capítulo da bíblia" },
    { id: "semana1-t14", texto: "1 capítulo da bíblia" },
    { id: "semana1-t15", texto: "1 capítulo da bíblia" },
    { id: "semana1-t16", texto: "1 capítulo da bíblia" },
    { id: "semana1-t17", texto: "1 capítulo da bíblia" },
    { id: "semana1-t18", texto: "Fazer visitas" },
    { id: "semana1-t19", texto: "50 abdominais" },
    { id: "semana1-t20", texto: "50 abdominais" },
    { id: "semana1-t21", texto: "50 abdominais" },
    { id: "semana1-t22", texto: "50 abdominais" },
    { id: "semana1-t23", texto: "50 abdominais" },
    { id: "semana1-t24", texto: "Mandar currículo" },
    { id: "semana1-t25", texto: "Mandar currículo" },
    { id: "semana1-t26", texto: "Mandar currículo" },
    { id: "semana1-t27", texto: "Mandar currículo" },
    { id: "semana1-t28", texto: "Mandar currículo" },
    { id: "semana1-t29", texto: "Fazer pastelão" },
    { id: "semana1-t30", texto: "Fazer pastelão" }
  ],
  semana2: [
    { id: "semana2-t1", texto: "20 flashcards em inglês" },
    { id: "semana2-t2", texto: "20 flashcards em inglês" },
    { id: "semana2-t3", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana2-t4", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana2-t5", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana2-t6", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana2-t7", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana2-t8", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana2-t9", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana2-t10", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana2-t11", texto: "1 capítulo da bíblia" },
    { id: "semana2-t12", texto: "1 capítulo da bíblia" },
    { id: "semana2-t13", texto: "1 capítulo da bíblia" },
    { id: "semana2-t14", texto: "1 capítulo da bíblia" },
    { id: "semana2-t15", texto: "1 capítulo da bíblia" },
    { id: "semana2-t16", texto: "1 capítulo da bíblia" },
    { id: "semana2-t17", texto: "1 capítulo da bíblia" },
    { id: "semana2-t18", texto: "Fazer visitas" },
    { id: "semana2-t19", texto: "50 abdominais" },
    { id: "semana2-t20", texto: "50 abdominais" },
    { id: "semana2-t21", texto: "50 abdominais" },
    { id: "semana2-t22", texto: "50 abdominais" },
    { id: "semana2-t23", texto: "50 abdominais" },
    { id: "semana2-t24", texto: "Mandar currículo" },
    { id: "semana2-t25", texto: "Mandar currículo" },
    { id: "semana2-t26", texto: "Mandar currículo" },
    { id: "semana2-t27", texto: "Mandar currículo" },
    { id: "semana2-t28", texto: "Mandar currículo" },
    { id: "semana2-t29", texto: "Fazer pastelão" },
    { id: "semana2-t30", texto: "Fazer pastelão" }
  ],
  semana3: [
    { id: "semana3-t1", texto: "20 flashcards em inglês" },
    { id: "semana3-t2", texto: "20 flashcards em inglês" },
    { id: "semana3-t3", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana3-t4", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana3-t5", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana3-t6", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana3-t7", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana3-t8", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana3-t9", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana3-t10", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana3-t11", texto: "1 capítulo da bíblia" },
    { id: "semana3-t12", texto: "1 capítulo da bíblia" },
    { id: "semana3-t13", texto: "1 capítulo da bíblia" },
    { id: "semana3-t14", texto: "1 capítulo da bíblia" },
    { id: "semana3-t15", texto: "1 capítulo da bíblia" },
    { id: "semana3-t16", texto: "1 capítulo da bíblia" },
    { id: "semana3-t17", texto: "1 capítulo da bíblia" },
    { id: "semana3-t18", texto: "Fazer visitas" },
    { id: "semana3-t19", texto: "50 abdominais" },
    { id: "semana3-t20", texto: "50 abdominais" },
    { id: "semana3-t21", texto: "50 abdominais" },
    { id: "semana3-t22", texto: "50 abdominais" },
    { id: "semana3-t23", texto: "50 abdominais" },
    { id: "semana3-t24", texto: "Mandar currículo" },
    { id: "semana3-t25", texto: "Mandar currículo" },
    { id: "semana3-t26", texto: "Mandar currículo" },
    { id: "semana3-t27", texto: "Mandar currículo" },
    { id: "semana3-t28", texto: "Mandar currículo" },
    { id: "semana3-t29", texto: "Fazer pastelão" },
    { id: "semana3-t30", texto: "Fazer pastelão" }
  ],
  semana4: [
    { id: "semana4-t1", texto: "20 flashcards em inglês" },
    { id: "semana4-t2", texto: "20 flashcards em inglês" },
    { id: "semana4-t3", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana4-t4", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana4-t5", texto: "FIAP: 1 capítulo + exercícios" },
    { id: "semana4-t6", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana4-t7", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana4-t8", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana4-t9", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana4-t10", texto: "Copiar código por 1 hora cronometrada" },
    { id: "semana4-t11", texto: "1 capítulo da bíblia" },
    { id: "semana4-t12", texto: "1 capítulo da bíblia" },
    { id: "semana4-t13", texto: "1 capítulo da bíblia" },
    { id: "semana4-t14", texto: "1 capítulo da bíblia" },
    { id: "semana4-t15", texto: "1 capítulo da bíblia" },
    { id: "semana4-t16", texto: "1 capítulo da bíblia" },
    { id: "semana4-t17", texto: "1 capítulo da bíblia" },
    { id: "semana4-t18", texto: "Fazer visitas" },
    { id: "semana4-t19", texto: "50 abdominais" },
    { id: "semana4-t20", texto: "50 abdominais" },
    { id: "semana4-t21", texto: "50 abdominais" },
    { id: "semana4-t22", texto: "50 abdominais" },
    { id: "semana4-t23", texto: "50 abdominais" },
    { id: "semana4-t24", texto: "Mandar currículo" },
    { id: "semana4-t25", texto: "Mandar currículo" },
    { id: "semana4-t26", texto: "Mandar currículo" },
    { id: "semana4-t27", texto: "Mandar currículo" },
    { id: "semana4-t28", texto: "Mandar currículo" },
    { id: "semana4-t29", texto: "Fazer pastelão" },
    { id: "semana4-t30", texto: "Fazer pastelão" }
  ]
};

function renderizarTarefas() {
  for (const [semana, tarefas] of Object.entries(tarefasPorSemana)) {
    const container = document.getElementById(`${semana}-tarefas`);
    if (container) {
      tarefas.forEach(tarefa => {
        const item = document.createElement('div');
        item.className = 'checkbox-item p-3 rounded-lg border border-gray-300 bg-white';

        item.innerHTML = `
          <label class="flex items-center cursor-pointer">
            <input type="checkbox" data-id="${tarefa.id}" class="mr-4 w-5 h-5 text-blue-600 rounded focus:ring-blue-500">
            <span class="text-gray-800">${tarefa.texto}</span>
          </label>
        `;

        container.appendChild(item);
      });
    }
  }
}



// LocalStorage functionality for checkboxes
class ChecklistManager {
  constructor() {
    this.init();
  }

  init() {
    this.loadCheckboxStates();
    this.attachEventListeners();
    this.updateProgress();
  }

  loadCheckboxStates() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
      const id = checkbox.getAttribute('data-id');
      const isChecked = localStorage.getItem(`checkbox_${id}`) === 'true';
      checkbox.checked = isChecked;
      this.updateCheckboxStyle(checkbox);
    });
  }

  attachEventListeners() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', (e) => {
        const id = e.target.getAttribute('data-id');
        localStorage.setItem(`checkbox_${id}`, e.target.checked);
        this.updateCheckboxStyle(e.target);
        this.updateProgress();
      });
    });
  }

  updateCheckboxStyle(checkbox) {
    const listItem = checkbox.closest('.checkbox-item');
    if (listItem) {
      if (checkbox.checked) {
        listItem.classList.add('completed');
      } else {
        listItem.classList.remove('completed');
      }
    }
  }

  updateProgress() {
    this.updateGeneralProgress();
    this.updatePlanProgress();
    this.updateWeeklyProgress();
  }

  updateGeneralProgress() {
    const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
    const checkedBoxes = document.querySelectorAll('input[type="checkbox"]:checked');
    const percentage = Math.round((checkedBoxes.length / allCheckboxes.length) * 100);

    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');

    if (progressBar && progressText) {
      progressBar.style.width = `${percentage}%`;
      progressText.textContent = `${percentage}%`;
    }
  }

  updatePlanProgress() {
    const planCheckboxes = document.querySelectorAll('#checklist input[type="checkbox"]');
    const planCheckedBoxes = document.querySelectorAll('#checklist input[type="checkbox"]:checked');
    const percentage = Math.round((planCheckedBoxes.length / planCheckboxes.length) * 100);

    const planProgressBar = document.getElementById('plan-progress-bar');
    const planProgressText = document.getElementById('plan-progress-text');

    if (planProgressBar && planProgressText) {
      planProgressBar.style.width = `${percentage}%`;
      planProgressText.textContent = `${planCheckedBoxes.length}/${planCheckboxes.length}`;
    }
  }

  updateWeeklyProgress() {
    // Semana 1
    const semana1Checkboxes = document.querySelectorAll('input[data-id^="semana1-"]');
    const semana1Checked = document.querySelectorAll('input[data-id^="semana1-"]:checked');
    const semana1Progress = document.getElementById('week1-progress');
    if (semana1Progress) {
      semana1Progress.textContent = `${semana1Checked.length}/${semana1Checkboxes.length}`;
    }

    // Semana 2
    const semana2Checkboxes = document.querySelectorAll('input[data-id^="semana2-"]');
    const semana2Checked = document.querySelectorAll('input[data-id^="semana2-"]:checked');
    const semana2Progress = document.getElementById('week2-progress');
    if (semana2Progress) {
      semana2Progress.textContent = `${semana2Checked.length}/${semana2Checkboxes.length}`;
    }

    // Semana 3
    const semana3Checkboxes = document.querySelectorAll('input[data-id^="semana3-"]');
    const semana3Checked = document.querySelectorAll('input[data-id^="semana3-"]:checked');
    const semana3Progress = document.getElementById('week3-progress');
    if (semana3Progress) {
      semana3Progress.textContent = `${semana3Checked.length}/${semana3Checkboxes.length}`;
    }

    // Semana 4
    const semana4Checkboxes = document.querySelectorAll('input[data-id^="semana4-"]');
    const semana4Checked = document.querySelectorAll('input[data-id^="semana4-"]:checked');
    const semana4Progress = document.getElementById('week4-progress');
    if (semana4Progress) {
      semana4Progress.textContent = `${semana4Checked.length}/${semana4Checkboxes.length}`;
    }
  }
}

// Initialize the checklist manager when the page loads
document.addEventListener('DOMContentLoaded', () => {
  renderizarTarefas();
  new ChecklistManager();
});
